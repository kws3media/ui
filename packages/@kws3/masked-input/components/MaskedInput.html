<div>
  <input class="input {class}" type='text' {placeholder} bind:value ref:input>
</div>

<script>
  import {createTextMaskInputElement, conformToMask} from 'text-mask-core/src';

  export default {
    data(){
      return {
        mask: [],
        showMask: false,
        guide: true,
        guideOnOutput: false,
        keepCharPositions: true,
        placeholder:'',
        class:''
      }
    },
    oncreate(){
      var self = this;
      let inputElement = self.refs.input;
      let {mask, showMask, guide, guideOnOutput, keepCharPositions } = self.get();
      let textMaskConfig = {
        inputElement,
        mask,
        showMask,
        guide,
        keepCharPositions
      }
      const textMaskInputElement = createTextMaskInputElement(textMaskConfig);

      textMaskInputElement.update(inputElement.value)

      self.on('state', function({changed, current}){
        if(changed.value){
          const result = conformToMask(current.value, mask, {
            guide: current.guideOnOutput
          })
          self.set({value: result.conformedValue});
          textMaskInputElement.update(current.value);
        }
      })
    }
  }


</script>