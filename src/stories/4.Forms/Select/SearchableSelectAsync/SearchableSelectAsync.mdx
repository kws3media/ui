import {
  Controls,
  Meta,
  Source,
  Canvas,
} from "@storybook/blocks";
import dedent from "ts-dedent";
import Version from "~/version.mdx";
import * as Stories from "./SearchableSelectAsync.stories";

<Version />

# SearchableSelect (Async)
## Example of Async loading options.

<Meta of={Stories} />
<Canvas />
<Controls />

<div className="notification is-primary is-light">
  <div className="columns">
    <div className="column">
      <h3>
        Async filter function <code>search</code>
      </h3>
      <div>
        This function is called when the user types in the search field.
        It is passed the search string and should return a promise that
        resolves to an array of options.
      </div>
      <div>
        This function is not called every keydown while the user is typing.
        It is called only when user finishes typing.
      </div>
      <div>
        Note: 
      </div>
      <ul>
        <li>Only send this prop if you want to fetch <code>options</code> asynchronously.</li>
        <li><code>options</code> prop will be ignored if this prop is set.</li>
        <li>To improve rendering performance, slice down the options if items array contains a large dataset on a single match.</li>
      </ul>
      <Source
        language="jsx"
        code={dedent`<SearchableSelect
      ...other_options
      search={async ()...... items.map(...).slice(0, 20);}
    
    </SearchableSelect>`}
      />
    </div>
    <div className="column">
      <h3>Example:</h3>
      <Source
        language="jsx"
        code={dedent`<SearchableSelect
      ...other_options
      search={async (filter) => {
        const response = await fetch(
          "https://api.github.com/search/users?q=" + filter
        );
        const json = await response.json();
        return json.items.map((item) => ({
          id: item.id,
          name: item.name,
        }));
      }}
    
    </SearchableSelect>`}
      />
    </div>
  </div>
</div>

### Usage

#### Import the component:

<Source
  code={dedent`import { SearchableSelect } from '@kws3/ui';`}
/>

#### Import the SCSS:

<Source
  code={dedent`@use '@kws3/ui/styles/Select.scss';`}
/>

#### SCSS customization variables with default values:

<Source
  language="css"
  code={dedent`
      @use '@kws3/ui/styles/Select.scss with(
        $colors: dv.$colors !default;
        $radius: cv.getVar("radius") !default;
        $focus-border-color: hsl(cv.getVar("input-focus-h"),cv.getVar("input-focus-s"),cv.getVar("input-focus-l")) !default;
        $focus-box-shadow-size: cv.getVar("input-focus-shadow-size") !default;
        $focus-box-shadow-color: hsl(cv.getVar("input-focus-h"),cv.getVar("input-focus-s"),cv.getVar("input-focus-l"),cv.getVar("input-focus-shadow-alpha")) !default;
        $disabled-background-color: cv.getVar("input-disabled-background-color") !default;
        $disabled-border-color: cv.getVar("input-disabled-border-color") !default;
        $disabled-color: cv.getVar("input-disabled-color") !default;
        $selecting-color: cv.getVar("primary-invert") !default;
        $selecting-background: cv.getVar("primary") !default;
        $selected-color: cv.getVar("primary-dark") !default;
        $selected-background: cv.getVar("primary-light") !default;
        $options-background: cv.getVar("scheme-main-ter") !default;
        $__modal-z: 41 !default;
      )
    `}
/>
